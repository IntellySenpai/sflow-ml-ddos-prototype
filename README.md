# 🛡️ DDoS Detection and Mitigation Prototype using sFlow, Machine Learning, and BGP RTBH

This prototype demonstrates a real-time, scalable, and intelligent system for **DDoS detection and mitigation**, leveraging:

- **sFlow** packet sampling and interface counters  
- **Machine Learning** for traffic classification and anomaly detection  
- **BGP RTBH** (Remote Triggered Black Hole) via **ExaBGP** for automated mitigation

> ⚠️ **Note**: This system is designed for research and demonstration purposes in a controlled environment. Mitigation of traffic generated by `tcpreplay` cannot be simulated due to internal replay limitations.

---

## 🚀 Features

- Detection of three DDoS attack types:
  - **SYN Flood**
  - **Bogus IP Protocol**
  - **TCP Reflection**
- Containerized microservice architecture with up to 13 services
- Preprocessing pipeline for transforming raw sFlow data into ML-ready features
- Real-time detection with a configurable detection interval
- Automated mitigation via **BGP RTBH** ([ExaBGP]("https://github.com/Exa-Networks/exabgp"))
- Supports labeling, evaluation, and fine-tuning of ML models

---

## 🧪 Getting Started

### Requirements

- `docker`
- `docker-compose`
- `make`

### Development Environment

To spin up the development environment:

```bash
make up
```

This will:
- Launch the **sFlow agent** configured to replay traffic using [Tcpreplay]("https://tcpreplay.appneta.com/")
- Start a **containerized FRR router** to simulate BGP-based mitigation. [Image used]("https://github.com/iwaseyusuke/docker-frr/tree/master)
- Initialize all services (parser, preprocessor, detector, TSDB, etc.)

> ℹ️ Traffic is replayed from predefined `.pcap` files simulating attack scenarios.

---

## ⚠️ Known Limitations

- Mitigation of `tcpreplay`-generated traffic **cannot be simulated** due to how replay works internally.
- The development setup is not intended for real-world deployment — it is optimized for prototype validation and experimentation.
- High sampling accuracy (e.g., Sampling 1, Polling 2) may cause bottlenecks in preprocessing.
- Issues with the AbuseIPDB HTTP requests after Daily Limit reached.

---

## 📁 Datasets & Code

- **Packet Captures, Labeled Datasets, and Training Files** can be found via [this URL]("https://shorturl.at/D1XeO")
- All code is open source and licensed under the [MIT License](LICENSE).

---

## 📄 License

This project is licensed under the **MIT License** — see the [LICENSE](LICENSE) file for details.

---

## 🤝 Contributions

Contributions, issues, and pull requests are welcome. If you plan to use this in your research or product, feel free to fork and extend it as needed.

---

## 📫 Contact

If you have questions or ideas, feel free to reach out via GitHub Issues or Discussions.
